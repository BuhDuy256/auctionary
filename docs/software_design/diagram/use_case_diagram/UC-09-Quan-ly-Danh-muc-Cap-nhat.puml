@startuml UC09_QuanLyDanhMucCapNhat
' --- Cài đặt Sơ đồ ---
autonumber
actor Admin
participant "Web Browser" as Browser
participant "Web Server\n(Controller)" as Controller
participant "Category Service\n(Business Logic)" as CategoryService
participant "Category Repository\n(Data Access)" as CategoryRepo
database "Database" as DB

' --- Luồng chính: Cập nhật Danh mục ---

Admin -> Browser : Đổi tên danh mục, nhấn "Cập nhật"
Browser -> Controller : Gửi yêu cầu (PUT /admin/categories/{id})

activate Controller
Controller -> CategoryService : updateCategory(categoryId, newData)
activate CategoryService

' 1. (Tùy chọn) Kiểm tra tồn tại
CategoryService -> CategoryRepo : findById(categoryId)
activate CategoryRepo
CategoryRepo -> DB : SELECT * FROM Categories WHERE id = :categoryId
activate DB
DB --> CategoryRepo : (Category)
deactivate DB
deactivate CategoryRepo

' 2. Cập nhật
CategoryService -> CategoryRepo : update(categoryId, newData)
activate CategoryRepo
CategoryRepo -> DB : UPDATE Categories SET name = :newName WHERE id = :categoryId
activate DB
DB --> CategoryRepo : OK
deactivate DB
deactivate CategoryRepo

CategoryService --> Controller : Trả về "Cập nhật thành công"
deactivate CategoryService

Controller -> Browser : Phản hồi (HTTP 200) / Tải lại trang
deactivate Controller

@enduml
